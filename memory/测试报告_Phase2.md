# Phase 2 æµ‹è¯•æŠ¥å‘Šï¼šå…«å­—å‘½æ ¼è®¡ç®— API

## æµ‹è¯•æ¦‚è¿°
- **æµ‹è¯•æ—¶é—´**: 2026-02-13
- **æµ‹è¯•èŒƒå›´**: å…«å­—è®¡ç®— API v1 ç‰ˆæœ¬
- **æµ‹è¯•ç»“æœ**: âœ… å…¨éƒ¨é€šè¿‡

---

## 1. å…¬å¼€è®¡ç®—æ¥å£æµ‹è¯•

### POST /api/v1/bazi/compute
**åŠŸèƒ½**: çº¯è®¡ç®—å…«å­—ï¼Œæ— éœ€ç™»å½•

**æµ‹è¯•æ¡ˆä¾‹ 1**: 1990-05-15 14:30
```bash
curl -X POST http://localhost:3002/api/v1/bazi/compute \
  -H "Content-Type: application/json" \
  -d '{
    "birthYear": 1990,
    "birthMonth": 5,
    "birthDay": 15,
    "birthHour": 14,
    "birthMinute": 30
  }'
```

**å“åº”**:
```json
{
  "success": true,
  "data": {
    "bazi": {
      "year": { "stem": "åºš", "branch": "åˆ", "element": "é‡‘" },
      "month": { "stem": "ç”²", "branch": "åˆ", "element": "æœ¨" },
      "day": { "stem": "å·±", "branch": "äº¥", "element": "åœŸ" },
      "hour": { "stem": "è¾›", "branch": "æœª", "element": "é‡‘" }
    },
    "wuxing": { "metal": 2, "wood": 1, "water": 1, "fire": 2, "earth": 2 },
    "lingGen": {
      "type": "wu",
      "name": "äº”çµæ ¹",
      "primaryElement": "é‡‘",
      "bonus": 0.8,
      "description": "ä¼ªçµæ ¹ï¼Œäº”è¡Œä¿±å…¨å´æ— ä¸€ç²¾é€šï¼Œä¿®ç‚¼è‰°éš¾ï¼Œä½†è‹¥èƒ½å¤§æˆå¯ä¿®äº”è¡Œç¥é€š"
    },
    "formatted": "åºšåˆ ç”²åˆ å·±äº¥ è¾›æœª"
  }
}
```

**æµ‹è¯•æ¡ˆä¾‹ 2**: 1984-01-01 0:00 (ç”²å­å¹´ï¼Œå˜å¼‚çµæ ¹)
```json
{
  "lingGen": {
    "type": "bianyi",
    "name": "å˜å¼‚çµæ ¹Â·é£",
    "primaryElement": "æœ¨",
    "bonus": 1.3,
    "description": "æ°´æœ¨ç›¸ç”Ÿï¼Œå˜å¼‚ä¸ºé£çµæ ¹ï¼Œä¿®ç‚¼æœ¨ç³»åŠŸæ³•å¨åŠ›å€å¢"
  }
}
```

---

## 2. è®¤è¯æ¥å£æµ‹è¯•

### æœªè®¤è¯è®¿é—®
**GET /api/v1/bazi/me** (æœªç™»å½•)
```json
{ "error": "æœªæä¾›è®¤è¯ä»¤ç‰Œ" }
```

**POST /api/v1/bazi/calculate** (æœªç™»å½•)
```json
{ "error": "æœªæä¾›è®¤è¯ä»¤ç‰Œ" }
```

âœ… **è®¤è¯ä¸­é—´ä»¶æ­£å¸¸å·¥ä½œ**

---

## 3. å‚æ•°éªŒè¯æµ‹è¯•

### ç¼ºå°‘å¿…è¦å‚æ•°
**è¯·æ±‚**:
```json
{ "birthYear": 1990 }
```

**å“åº”**:
```json
{
  "success": false,
  "error": "ç¼ºå°‘å¿…è¦å‚æ•°: birthYear, birthMonth, birthDay, birthHour"
}
```

### æ— æ•ˆæ—¥æœŸ
**è¯·æ±‚**:
```json
{
  "birthYear": 1990,
  "birthMonth": 2,
  "birthDay": 30,
  "birthHour": 12
}
```

**å“åº”**:
```json
{
  "success": false,
  "error": "æ— æ•ˆçš„æ—¥æœŸ"
}
```

âœ… **å‚æ•°éªŒè¯æ­£å¸¸å·¥ä½œ**

---

## 4. æ—¶è¾°è®¡ç®—æµ‹è¯•

| è¾“å…¥æ—¶é—´ | é¢„æœŸæ—¶æ”¯ | å®é™…æ—¶æ”¯ | ç»“æœ |
|----------|----------|----------|------|
| 23:00 | å­ | å­ | âœ… |
| 00:00 | å­ | å­ | âœ… |
| 12:00 | åˆ | åˆ | âœ… |
| 14:00 | æœª | æœª | âœ… |

---

## 5. çµæ ¹åˆ¤å®šæµ‹è¯•

| å‡ºç”Ÿæ—¶é—´ | å…«å­— | äº”è¡Œåˆ†å¸ƒ | é¢„æœŸçµæ ¹ | ç»“æœ |
|----------|------|----------|----------|------|
| 1990-05-15 14:30 | åºšåˆç”²åˆå·±äº¥è¾›æœª | é‡‘2æœ¨1æ°´1ç«2åœŸ2 | äº”çµæ ¹ | âœ… |
| 1984-01-01 0:00 | ç”²å­æˆŠå¯…ç”²å¯…ç”²å­ | æœ¨5æ°´2 | å˜å¼‚çµæ ¹Â·é£ | âœ… |

---

## 6. API è·¯ç”±æ±‡æ€»

| æ¥å£ | æ–¹æ³• | è·¯å¾„ | è®¤è¯ | çŠ¶æ€ |
|------|------|------|------|------|
| è®¡ç®—å¹¶ä¿å­˜ | POST | /api/v1/bazi/calculate | âœ… éœ€è¦ | âœ… æ­£å¸¸ |
| è·å–å…«å­— | GET | /api/v1/bazi/me | âœ… éœ€è¦ | âœ… æ­£å¸¸ |
| çº¯è®¡ç®— | POST | /api/v1/bazi/compute | âŒ æ— éœ€ | âœ… æ­£å¸¸ |

---

## 7. æµ‹è¯•ç»“è®º

### é€šè¿‡é¡¹ âœ…
- å…«å­—å››æŸ±è®¡ç®—æ­£ç¡®
- äº”è¡Œç»Ÿè®¡å‡†ç¡®
- çµæ ¹åˆ¤å®šé€»è¾‘æ­£ç¡®
- å˜å¼‚çµæ ¹ç‰¹æ®Šç»„åˆè¯†åˆ«
- å‚æ•°éªŒè¯å®Œæ•´
- è®¤è¯æœºåˆ¶æ­£å¸¸
- API å“åº”æ ¼å¼ç¬¦åˆè§„èŒƒ

### å¾…ä¼˜åŒ–é¡¹ ğŸ“
- å¯æ·»åŠ æ›´å¤šå˜å¼‚çµæ ¹ç»„åˆ
- å¯æ·»åŠ åœ°æ”¯è—å¹²æƒé‡è®¡ç®—
- å¯è€ƒè™‘èŠ‚æ°”å¯¹æœˆæŸ±çš„å½±å“

### æ€»ä½“è¯„ä»·
**Phase 2 å¼€å‘ä»»åŠ¡å·²å…¨éƒ¨å®Œæˆï¼ŒAPI å¯ç”¨ä¸”ç¨³å®šï¼Œå¯è¿›å…¥ Phase 3 ä¿®ç‚¼ç³»ç»Ÿå¼€å‘ã€‚**

---

## 8. æµ‹è¯•è„šæœ¬

### å¿«é€Ÿæµ‹è¯•å‘½ä»¤

```bash
# å¯åŠ¨æœåŠ¡å™¨
cd projects/immortal-cultivation/backend
npm run build
PORT=3002 npm start

# æµ‹è¯•å…¬å¼€è®¡ç®—æ¥å£
curl -X POST http://localhost:3002/api/v1/bazi/compute \
  -H "Content-Type: application/json" \
  -d '{"birthYear":1990,"birthMonth":5,"birthDay":15,"birthHour":14}'

# æµ‹è¯•å¥åº·æ£€æŸ¥
curl http://localhost:3002/api/health

# è¿è¡Œå®Œæ•´æµ‹è¯•
cd projects/immortal-cultivation/backend
node test-bazi.js
```
